{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "import pandas as pd "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['coal_clear.csv', 'fsnd_GDP_A020101.csv', 'fsnd_POP_A030101.csv', 'gas_clear.csv', 'pre_coal.csv', 'pre_gas.csv']\n"
     ]
    }
   ],
   "source": [
    "import glob\n",
    "print(glob.glob(\"*.csv\"))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "df_try = pd.read_table(\"pre_gas.csv\",   \n",
    "                       encoding = 'utf8',        \n",
    "                      )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>地区,2015年,2014年,2013年,2012年,2011年,2010年,2009年,2008年,2007年,2006年</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>北京市,144.49,113.69,98.95,92.48,72.96,71.97,68.2...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>天津市,30.66,30.1,28.19,25.62,16.97,16.95,14.97,1...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>河北省,31.42,25.74,24.4,21.45,19.35,10.67,8.91,5....</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>山西省,24.74,17.76,23.31,21.35,17.63,14.14,10.32,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>内蒙古自治区,13.32,11.09,10.47,11.3,12.77,6.95,4.61,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>辽宁省,17.04,12.68,9.77,8.57,7.66,6.62,6,5.77,5.4...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>吉林省,11.14,11.54,8.58,6.97,5.18,4.35,3.38,3.02,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>黑龙江省,11.32,11.66,11.11,8.82,8.51,7.25,4.68,2.7...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>上海市,73.48,69.61,69.09,63.11,54.33,45,33.44,29....</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>江苏省,96.98,84.21,76.59,69.18,59.15,47.23,34.35,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>浙江省,31.93,32.81,23.01,19.13,14.87,11.89,8.65,6...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>安徽省,23.46,21.97,19.91,17.13,13.88,11.22,8.93,6...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>福建省,14.88,13.23,11.24,9.53,6.63,5.11,1.03,0.23...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>江西省,7.36,6.91,5.61,4.19,2.7,1.13,0.62,0.41,0.3...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>山东省,63.39,62.75,61.08,51.83,43.8,32.69,24.29,2...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>河南省,33.28,30.52,28.86,24.13,19.47,15.89,12.67,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>湖北省,33.04,30.94,28.53,24.08,20.45,15.28,11.77,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>湖南省,21.55,21.72,19.97,16.13,13.91,11.18,9.58,7...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>广东省,123.29,129.13,123.17,117.45,118.33,17.03,1...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>广西壮族自治区,3.88,2.85,2.22,1.69,1.36,1.03,0.71,0.4...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>海南省,2.9,2.76,2.53,1.77,1.64,1.43,1.28,1.49,1.3...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>重庆市,34.94,32.15,32.43,32.5,26.88,25.4,20.52,18...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>四川省,62.8,61,59.02,56.83,56.46,52.57,51.11,59.5...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>贵州省,3.29,2.9,1.61,0.99,0.55,0.35,0.23,0.14,0.1...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>云南省,0.73,0.44,0.23,0.12,0.02,0.01,0.01,0.07,0....</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>西藏自治区,0.13,0,12.75,,,,,,,0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>陕西省,31.13,28.58,23.87,22.12,18.25,16.47,14.43,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>甘肃省,16.19,15.92,13.4,11.21,8.81,7.29,5.95,5.34...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>青海省,13.3,12.98,11.9,11.19,6.57,6.16,15.26,11.8...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>宁夏回族自治区,19.93,21.87,21.09,17.91,12.26,10.85,6....</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>新疆维吾尔自治区,44.78,44.83,38.09,26.27,17.44,13.47,1...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>数据来源：国家统计局,,,,,,,,,,</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   地区,2015年,2014年,2013年,2012年,2011年,2010年,2009年,2008年,2007年,2006年\n",
       "0   北京市,144.49,113.69,98.95,92.48,72.96,71.97,68.2...            \n",
       "1   天津市,30.66,30.1,28.19,25.62,16.97,16.95,14.97,1...            \n",
       "2   河北省,31.42,25.74,24.4,21.45,19.35,10.67,8.91,5....            \n",
       "3   山西省,24.74,17.76,23.31,21.35,17.63,14.14,10.32,...            \n",
       "4   内蒙古自治区,13.32,11.09,10.47,11.3,12.77,6.95,4.61,...            \n",
       "5   辽宁省,17.04,12.68,9.77,8.57,7.66,6.62,6,5.77,5.4...            \n",
       "6   吉林省,11.14,11.54,8.58,6.97,5.18,4.35,3.38,3.02,...            \n",
       "7   黑龙江省,11.32,11.66,11.11,8.82,8.51,7.25,4.68,2.7...            \n",
       "8   上海市,73.48,69.61,69.09,63.11,54.33,45,33.44,29....            \n",
       "9   江苏省,96.98,84.21,76.59,69.18,59.15,47.23,34.35,...            \n",
       "10  浙江省,31.93,32.81,23.01,19.13,14.87,11.89,8.65,6...            \n",
       "11  安徽省,23.46,21.97,19.91,17.13,13.88,11.22,8.93,6...            \n",
       "12  福建省,14.88,13.23,11.24,9.53,6.63,5.11,1.03,0.23...            \n",
       "13  江西省,7.36,6.91,5.61,4.19,2.7,1.13,0.62,0.41,0.3...            \n",
       "14  山东省,63.39,62.75,61.08,51.83,43.8,32.69,24.29,2...            \n",
       "15  河南省,33.28,30.52,28.86,24.13,19.47,15.89,12.67,...            \n",
       "16  湖北省,33.04,30.94,28.53,24.08,20.45,15.28,11.77,...            \n",
       "17  湖南省,21.55,21.72,19.97,16.13,13.91,11.18,9.58,7...            \n",
       "18  广东省,123.29,129.13,123.17,117.45,118.33,17.03,1...            \n",
       "19  广西壮族自治区,3.88,2.85,2.22,1.69,1.36,1.03,0.71,0.4...            \n",
       "20  海南省,2.9,2.76,2.53,1.77,1.64,1.43,1.28,1.49,1.3...            \n",
       "21  重庆市,34.94,32.15,32.43,32.5,26.88,25.4,20.52,18...            \n",
       "22  四川省,62.8,61,59.02,56.83,56.46,52.57,51.11,59.5...            \n",
       "23  贵州省,3.29,2.9,1.61,0.99,0.55,0.35,0.23,0.14,0.1...            \n",
       "24  云南省,0.73,0.44,0.23,0.12,0.02,0.01,0.01,0.07,0....            \n",
       "25                         西藏自治区,0.13,0,12.75,,,,,,,0            \n",
       "26  陕西省,31.13,28.58,23.87,22.12,18.25,16.47,14.43,...            \n",
       "27  甘肃省,16.19,15.92,13.4,11.21,8.81,7.29,5.95,5.34...            \n",
       "28  青海省,13.3,12.98,11.9,11.19,6.57,6.16,15.26,11.8...            \n",
       "29  宁夏回族自治区,19.93,21.87,21.09,17.91,12.26,10.85,6....            \n",
       "30  新疆维吾尔自治区,44.78,44.83,38.09,26.27,17.44,13.47,1...            \n",
       "31                               数据来源：国家统计局,,,,,,,,,,            "
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_try"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>地区,2015年,2014年,2013年,2012年,2011年,2010年,2009年,2008年,2007年,2006年</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>北京市,144.49,113.69,98.95,92.48,72.96,71.97,68.2...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>天津市,30.66,30.1,28.19,25.62,16.97,16.95,14.97,1...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>河北省,31.42,25.74,24.4,21.45,19.35,10.67,8.91,5....</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>山西省,24.74,17.76,23.31,21.35,17.63,14.14,10.32,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>内蒙古自治区,13.32,11.09,10.47,11.3,12.77,6.95,4.61,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>辽宁省,17.04,12.68,9.77,8.57,7.66,6.62,6,5.77,5.4...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>吉林省,11.14,11.54,8.58,6.97,5.18,4.35,3.38,3.02,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>黑龙江省,11.32,11.66,11.11,8.82,8.51,7.25,4.68,2.7...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>上海市,73.48,69.61,69.09,63.11,54.33,45,33.44,29....</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>江苏省,96.98,84.21,76.59,69.18,59.15,47.23,34.35,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>浙江省,31.93,32.81,23.01,19.13,14.87,11.89,8.65,6...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>安徽省,23.46,21.97,19.91,17.13,13.88,11.22,8.93,6...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>福建省,14.88,13.23,11.24,9.53,6.63,5.11,1.03,0.23...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>江西省,7.36,6.91,5.61,4.19,2.7,1.13,0.62,0.41,0.3...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>山东省,63.39,62.75,61.08,51.83,43.8,32.69,24.29,2...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>河南省,33.28,30.52,28.86,24.13,19.47,15.89,12.67,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>湖北省,33.04,30.94,28.53,24.08,20.45,15.28,11.77,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>湖南省,21.55,21.72,19.97,16.13,13.91,11.18,9.58,7...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>广东省,123.29,129.13,123.17,117.45,118.33,17.03,1...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>广西壮族自治区,3.88,2.85,2.22,1.69,1.36,1.03,0.71,0.4...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>海南省,2.9,2.76,2.53,1.77,1.64,1.43,1.28,1.49,1.3...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>重庆市,34.94,32.15,32.43,32.5,26.88,25.4,20.52,18...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>四川省,62.8,61,59.02,56.83,56.46,52.57,51.11,59.5...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>贵州省,3.29,2.9,1.61,0.99,0.55,0.35,0.23,0.14,0.1...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>云南省,0.73,0.44,0.23,0.12,0.02,0.01,0.01,0.07,0....</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>西藏自治区,0.13,0,12.75,,,,,,,0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>陕西省,31.13,28.58,23.87,22.12,18.25,16.47,14.43,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>甘肃省,16.19,15.92,13.4,11.21,8.81,7.29,5.95,5.34...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>青海省,13.3,12.98,11.9,11.19,6.57,6.16,15.26,11.8...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>宁夏回族自治区,19.93,21.87,21.09,17.91,12.26,10.85,6....</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>新疆维吾尔自治区,44.78,44.83,38.09,26.27,17.44,13.47,1...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   地区,2015年,2014年,2013年,2012年,2011年,2010年,2009年,2008年,2007年,2006年\n",
       "0   北京市,144.49,113.69,98.95,92.48,72.96,71.97,68.2...            \n",
       "1   天津市,30.66,30.1,28.19,25.62,16.97,16.95,14.97,1...            \n",
       "2   河北省,31.42,25.74,24.4,21.45,19.35,10.67,8.91,5....            \n",
       "3   山西省,24.74,17.76,23.31,21.35,17.63,14.14,10.32,...            \n",
       "4   内蒙古自治区,13.32,11.09,10.47,11.3,12.77,6.95,4.61,...            \n",
       "5   辽宁省,17.04,12.68,9.77,8.57,7.66,6.62,6,5.77,5.4...            \n",
       "6   吉林省,11.14,11.54,8.58,6.97,5.18,4.35,3.38,3.02,...            \n",
       "7   黑龙江省,11.32,11.66,11.11,8.82,8.51,7.25,4.68,2.7...            \n",
       "8   上海市,73.48,69.61,69.09,63.11,54.33,45,33.44,29....            \n",
       "9   江苏省,96.98,84.21,76.59,69.18,59.15,47.23,34.35,...            \n",
       "10  浙江省,31.93,32.81,23.01,19.13,14.87,11.89,8.65,6...            \n",
       "11  安徽省,23.46,21.97,19.91,17.13,13.88,11.22,8.93,6...            \n",
       "12  福建省,14.88,13.23,11.24,9.53,6.63,5.11,1.03,0.23...            \n",
       "13  江西省,7.36,6.91,5.61,4.19,2.7,1.13,0.62,0.41,0.3...            \n",
       "14  山东省,63.39,62.75,61.08,51.83,43.8,32.69,24.29,2...            \n",
       "15  河南省,33.28,30.52,28.86,24.13,19.47,15.89,12.67,...            \n",
       "16  湖北省,33.04,30.94,28.53,24.08,20.45,15.28,11.77,...            \n",
       "17  湖南省,21.55,21.72,19.97,16.13,13.91,11.18,9.58,7...            \n",
       "18  广东省,123.29,129.13,123.17,117.45,118.33,17.03,1...            \n",
       "19  广西壮族自治区,3.88,2.85,2.22,1.69,1.36,1.03,0.71,0.4...            \n",
       "20  海南省,2.9,2.76,2.53,1.77,1.64,1.43,1.28,1.49,1.3...            \n",
       "21  重庆市,34.94,32.15,32.43,32.5,26.88,25.4,20.52,18...            \n",
       "22  四川省,62.8,61,59.02,56.83,56.46,52.57,51.11,59.5...            \n",
       "23  贵州省,3.29,2.9,1.61,0.99,0.55,0.35,0.23,0.14,0.1...            \n",
       "24  云南省,0.73,0.44,0.23,0.12,0.02,0.01,0.01,0.07,0....            \n",
       "25                         西藏自治区,0.13,0,12.75,,,,,,,0            \n",
       "26  陕西省,31.13,28.58,23.87,22.12,18.25,16.47,14.43,...            \n",
       "27  甘肃省,16.19,15.92,13.4,11.21,8.81,7.29,5.95,5.34...            \n",
       "28  青海省,13.3,12.98,11.9,11.19,6.57,6.16,15.26,11.8...            \n",
       "29  宁夏回族自治区,19.93,21.87,21.09,17.91,12.26,10.85,6....            \n",
       "30  新疆维吾尔自治区,44.78,44.83,38.09,26.27,17.44,13.47,1...            "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df    = pd.read_table(\"pre_gas.csv\",   \n",
    "                       encoding = 'utf8',                    \n",
    "                       skiprows = [32]       \n",
    "                     )\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>地区</th>\n",
       "      <th>2015年</th>\n",
       "      <th>2014年</th>\n",
       "      <th>2013年</th>\n",
       "      <th>2012年</th>\n",
       "      <th>2011年</th>\n",
       "      <th>2010年</th>\n",
       "      <th>2009年</th>\n",
       "      <th>2008年</th>\n",
       "      <th>2007年</th>\n",
       "      <th>2006年</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>北京市</td>\n",
       "      <td>144.49</td>\n",
       "      <td>113.69</td>\n",
       "      <td>98.95</td>\n",
       "      <td>92.48</td>\n",
       "      <td>72.96</td>\n",
       "      <td>71.97</td>\n",
       "      <td>68.28</td>\n",
       "      <td>60.14</td>\n",
       "      <td>43.38</td>\n",
       "      <td>38.38</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>天津市</td>\n",
       "      <td>30.66</td>\n",
       "      <td>30.10</td>\n",
       "      <td>28.19</td>\n",
       "      <td>25.62</td>\n",
       "      <td>16.97</td>\n",
       "      <td>16.95</td>\n",
       "      <td>14.97</td>\n",
       "      <td>13.86</td>\n",
       "      <td>12.01</td>\n",
       "      <td>9.26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>河北省</td>\n",
       "      <td>31.42</td>\n",
       "      <td>25.74</td>\n",
       "      <td>24.40</td>\n",
       "      <td>21.45</td>\n",
       "      <td>19.35</td>\n",
       "      <td>10.67</td>\n",
       "      <td>8.91</td>\n",
       "      <td>5.99</td>\n",
       "      <td>4.84</td>\n",
       "      <td>3.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>山西省</td>\n",
       "      <td>24.74</td>\n",
       "      <td>17.76</td>\n",
       "      <td>23.31</td>\n",
       "      <td>21.35</td>\n",
       "      <td>17.63</td>\n",
       "      <td>14.14</td>\n",
       "      <td>10.32</td>\n",
       "      <td>8.96</td>\n",
       "      <td>6.53</td>\n",
       "      <td>5.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>内蒙古自治区</td>\n",
       "      <td>13.32</td>\n",
       "      <td>11.09</td>\n",
       "      <td>10.47</td>\n",
       "      <td>11.30</td>\n",
       "      <td>12.77</td>\n",
       "      <td>6.95</td>\n",
       "      <td>4.61</td>\n",
       "      <td>3.81</td>\n",
       "      <td>3.05</td>\n",
       "      <td>1.84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>辽宁省</td>\n",
       "      <td>17.04</td>\n",
       "      <td>12.68</td>\n",
       "      <td>9.77</td>\n",
       "      <td>8.57</td>\n",
       "      <td>7.66</td>\n",
       "      <td>6.62</td>\n",
       "      <td>6.00</td>\n",
       "      <td>5.77</td>\n",
       "      <td>5.41</td>\n",
       "      <td>5.35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>吉林省</td>\n",
       "      <td>11.14</td>\n",
       "      <td>11.54</td>\n",
       "      <td>8.58</td>\n",
       "      <td>6.97</td>\n",
       "      <td>5.18</td>\n",
       "      <td>4.35</td>\n",
       "      <td>3.38</td>\n",
       "      <td>3.02</td>\n",
       "      <td>2.69</td>\n",
       "      <td>2.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>黑龙江省</td>\n",
       "      <td>11.32</td>\n",
       "      <td>11.66</td>\n",
       "      <td>11.11</td>\n",
       "      <td>8.82</td>\n",
       "      <td>8.51</td>\n",
       "      <td>7.25</td>\n",
       "      <td>4.68</td>\n",
       "      <td>2.76</td>\n",
       "      <td>2.36</td>\n",
       "      <td>2.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>上海市</td>\n",
       "      <td>73.48</td>\n",
       "      <td>69.61</td>\n",
       "      <td>69.09</td>\n",
       "      <td>63.11</td>\n",
       "      <td>54.33</td>\n",
       "      <td>45.00</td>\n",
       "      <td>33.44</td>\n",
       "      <td>29.86</td>\n",
       "      <td>27.75</td>\n",
       "      <td>23.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>江苏省</td>\n",
       "      <td>96.98</td>\n",
       "      <td>84.21</td>\n",
       "      <td>76.59</td>\n",
       "      <td>69.18</td>\n",
       "      <td>59.15</td>\n",
       "      <td>47.23</td>\n",
       "      <td>34.35</td>\n",
       "      <td>29.97</td>\n",
       "      <td>26.09</td>\n",
       "      <td>15.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>浙江省</td>\n",
       "      <td>31.93</td>\n",
       "      <td>32.81</td>\n",
       "      <td>23.01</td>\n",
       "      <td>19.13</td>\n",
       "      <td>14.87</td>\n",
       "      <td>11.89</td>\n",
       "      <td>8.65</td>\n",
       "      <td>6.56</td>\n",
       "      <td>5.06</td>\n",
       "      <td>2.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>安徽省</td>\n",
       "      <td>23.46</td>\n",
       "      <td>21.97</td>\n",
       "      <td>19.91</td>\n",
       "      <td>17.13</td>\n",
       "      <td>13.88</td>\n",
       "      <td>11.22</td>\n",
       "      <td>8.93</td>\n",
       "      <td>6.85</td>\n",
       "      <td>4.79</td>\n",
       "      <td>3.08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>福建省</td>\n",
       "      <td>14.88</td>\n",
       "      <td>13.23</td>\n",
       "      <td>11.24</td>\n",
       "      <td>9.53</td>\n",
       "      <td>6.63</td>\n",
       "      <td>5.11</td>\n",
       "      <td>1.03</td>\n",
       "      <td>0.23</td>\n",
       "      <td>0.08</td>\n",
       "      <td>0.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>江西省</td>\n",
       "      <td>7.36</td>\n",
       "      <td>6.91</td>\n",
       "      <td>5.61</td>\n",
       "      <td>4.19</td>\n",
       "      <td>2.70</td>\n",
       "      <td>1.13</td>\n",
       "      <td>0.62</td>\n",
       "      <td>0.41</td>\n",
       "      <td>0.35</td>\n",
       "      <td>0.23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>山东省</td>\n",
       "      <td>63.39</td>\n",
       "      <td>62.75</td>\n",
       "      <td>61.08</td>\n",
       "      <td>51.83</td>\n",
       "      <td>43.80</td>\n",
       "      <td>32.69</td>\n",
       "      <td>24.29</td>\n",
       "      <td>25.74</td>\n",
       "      <td>14.26</td>\n",
       "      <td>12.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>河南省</td>\n",
       "      <td>33.28</td>\n",
       "      <td>30.52</td>\n",
       "      <td>28.86</td>\n",
       "      <td>24.13</td>\n",
       "      <td>19.47</td>\n",
       "      <td>15.89</td>\n",
       "      <td>12.67</td>\n",
       "      <td>10.10</td>\n",
       "      <td>8.52</td>\n",
       "      <td>7.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>湖北省</td>\n",
       "      <td>33.04</td>\n",
       "      <td>30.94</td>\n",
       "      <td>28.53</td>\n",
       "      <td>24.08</td>\n",
       "      <td>20.45</td>\n",
       "      <td>15.28</td>\n",
       "      <td>11.77</td>\n",
       "      <td>9.44</td>\n",
       "      <td>7.62</td>\n",
       "      <td>3.50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>湖南省</td>\n",
       "      <td>21.55</td>\n",
       "      <td>21.72</td>\n",
       "      <td>19.97</td>\n",
       "      <td>16.13</td>\n",
       "      <td>13.91</td>\n",
       "      <td>11.18</td>\n",
       "      <td>9.58</td>\n",
       "      <td>7.71</td>\n",
       "      <td>5.32</td>\n",
       "      <td>2.44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>广东省</td>\n",
       "      <td>123.29</td>\n",
       "      <td>129.13</td>\n",
       "      <td>123.17</td>\n",
       "      <td>117.45</td>\n",
       "      <td>118.33</td>\n",
       "      <td>17.03</td>\n",
       "      <td>11.71</td>\n",
       "      <td>8.30</td>\n",
       "      <td>4.14</td>\n",
       "      <td>2.87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>广西壮族自治区</td>\n",
       "      <td>3.88</td>\n",
       "      <td>2.85</td>\n",
       "      <td>2.22</td>\n",
       "      <td>1.69</td>\n",
       "      <td>1.36</td>\n",
       "      <td>1.03</td>\n",
       "      <td>0.71</td>\n",
       "      <td>0.47</td>\n",
       "      <td>0.23</td>\n",
       "      <td>0.12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>海南省</td>\n",
       "      <td>2.90</td>\n",
       "      <td>2.76</td>\n",
       "      <td>2.53</td>\n",
       "      <td>1.77</td>\n",
       "      <td>1.64</td>\n",
       "      <td>1.43</td>\n",
       "      <td>1.28</td>\n",
       "      <td>1.49</td>\n",
       "      <td>1.39</td>\n",
       "      <td>1.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>重庆市</td>\n",
       "      <td>34.94</td>\n",
       "      <td>32.15</td>\n",
       "      <td>32.43</td>\n",
       "      <td>32.50</td>\n",
       "      <td>26.88</td>\n",
       "      <td>25.40</td>\n",
       "      <td>20.52</td>\n",
       "      <td>18.79</td>\n",
       "      <td>17.51</td>\n",
       "      <td>17.39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>四川省</td>\n",
       "      <td>62.80</td>\n",
       "      <td>61.00</td>\n",
       "      <td>59.02</td>\n",
       "      <td>56.83</td>\n",
       "      <td>56.46</td>\n",
       "      <td>52.57</td>\n",
       "      <td>51.11</td>\n",
       "      <td>59.50</td>\n",
       "      <td>62.99</td>\n",
       "      <td>47.81</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>贵州省</td>\n",
       "      <td>3.29</td>\n",
       "      <td>2.90</td>\n",
       "      <td>1.61</td>\n",
       "      <td>0.99</td>\n",
       "      <td>0.55</td>\n",
       "      <td>0.35</td>\n",
       "      <td>0.23</td>\n",
       "      <td>0.14</td>\n",
       "      <td>0.14</td>\n",
       "      <td>0.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>云南省</td>\n",
       "      <td>0.73</td>\n",
       "      <td>0.44</td>\n",
       "      <td>0.23</td>\n",
       "      <td>0.12</td>\n",
       "      <td>0.02</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.01</td>\n",
       "      <td>0.07</td>\n",
       "      <td>0.08</td>\n",
       "      <td>0.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>西藏自治区</td>\n",
       "      <td>0.13</td>\n",
       "      <td>0.00</td>\n",
       "      <td>12.75</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>陕西省</td>\n",
       "      <td>31.13</td>\n",
       "      <td>28.58</td>\n",
       "      <td>23.87</td>\n",
       "      <td>22.12</td>\n",
       "      <td>18.25</td>\n",
       "      <td>16.47</td>\n",
       "      <td>14.43</td>\n",
       "      <td>12.35</td>\n",
       "      <td>10.80</td>\n",
       "      <td>9.91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>甘肃省</td>\n",
       "      <td>16.19</td>\n",
       "      <td>15.92</td>\n",
       "      <td>13.40</td>\n",
       "      <td>11.21</td>\n",
       "      <td>8.81</td>\n",
       "      <td>7.29</td>\n",
       "      <td>5.95</td>\n",
       "      <td>5.34</td>\n",
       "      <td>4.70</td>\n",
       "      <td>4.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>青海省</td>\n",
       "      <td>13.30</td>\n",
       "      <td>12.98</td>\n",
       "      <td>11.90</td>\n",
       "      <td>11.19</td>\n",
       "      <td>6.57</td>\n",
       "      <td>6.16</td>\n",
       "      <td>15.26</td>\n",
       "      <td>11.84</td>\n",
       "      <td>10.38</td>\n",
       "      <td>7.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>宁夏回族自治区</td>\n",
       "      <td>19.93</td>\n",
       "      <td>21.87</td>\n",
       "      <td>21.09</td>\n",
       "      <td>17.91</td>\n",
       "      <td>12.26</td>\n",
       "      <td>10.85</td>\n",
       "      <td>6.96</td>\n",
       "      <td>9.89</td>\n",
       "      <td>9.08</td>\n",
       "      <td>7.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>新疆维吾尔自治区</td>\n",
       "      <td>44.78</td>\n",
       "      <td>44.83</td>\n",
       "      <td>38.09</td>\n",
       "      <td>26.27</td>\n",
       "      <td>17.44</td>\n",
       "      <td>13.47</td>\n",
       "      <td>10.45</td>\n",
       "      <td>8.66</td>\n",
       "      <td>7.06</td>\n",
       "      <td>5.60</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "          地区   2015年   2014年   2013年   2012年   2011年  2010年  2009年  2008年  \\\n",
       "0        北京市  144.49  113.69   98.95   92.48   72.96  71.97  68.28  60.14   \n",
       "1        天津市   30.66   30.10   28.19   25.62   16.97  16.95  14.97  13.86   \n",
       "2        河北省   31.42   25.74   24.40   21.45   19.35  10.67   8.91   5.99   \n",
       "3        山西省   24.74   17.76   23.31   21.35   17.63  14.14  10.32   8.96   \n",
       "4     内蒙古自治区   13.32   11.09   10.47   11.30   12.77   6.95   4.61   3.81   \n",
       "5        辽宁省   17.04   12.68    9.77    8.57    7.66   6.62   6.00   5.77   \n",
       "6        吉林省   11.14   11.54    8.58    6.97    5.18   4.35   3.38   3.02   \n",
       "7       黑龙江省   11.32   11.66   11.11    8.82    8.51   7.25   4.68   2.76   \n",
       "8        上海市   73.48   69.61   69.09   63.11   54.33  45.00  33.44  29.86   \n",
       "9        江苏省   96.98   84.21   76.59   69.18   59.15  47.23  34.35  29.97   \n",
       "10       浙江省   31.93   32.81   23.01   19.13   14.87  11.89   8.65   6.56   \n",
       "11       安徽省   23.46   21.97   19.91   17.13   13.88  11.22   8.93   6.85   \n",
       "12       福建省   14.88   13.23   11.24    9.53    6.63   5.11   1.03   0.23   \n",
       "13       江西省    7.36    6.91    5.61    4.19    2.70   1.13   0.62   0.41   \n",
       "14       山东省   63.39   62.75   61.08   51.83   43.80  32.69  24.29  25.74   \n",
       "15       河南省   33.28   30.52   28.86   24.13   19.47  15.89  12.67  10.10   \n",
       "16       湖北省   33.04   30.94   28.53   24.08   20.45  15.28  11.77   9.44   \n",
       "17       湖南省   21.55   21.72   19.97   16.13   13.91  11.18   9.58   7.71   \n",
       "18       广东省  123.29  129.13  123.17  117.45  118.33  17.03  11.71   8.30   \n",
       "19   广西壮族自治区    3.88    2.85    2.22    1.69    1.36   1.03   0.71   0.47   \n",
       "20       海南省    2.90    2.76    2.53    1.77    1.64   1.43   1.28   1.49   \n",
       "21       重庆市   34.94   32.15   32.43   32.50   26.88  25.40  20.52  18.79   \n",
       "22       四川省   62.80   61.00   59.02   56.83   56.46  52.57  51.11  59.50   \n",
       "23       贵州省    3.29    2.90    1.61    0.99    0.55   0.35   0.23   0.14   \n",
       "24       云南省    0.73    0.44    0.23    0.12    0.02   0.01   0.01   0.07   \n",
       "25     西藏自治区    0.13    0.00   12.75     NaN     NaN    NaN    NaN    NaN   \n",
       "26       陕西省   31.13   28.58   23.87   22.12   18.25  16.47  14.43  12.35   \n",
       "27       甘肃省   16.19   15.92   13.40   11.21    8.81   7.29   5.95   5.34   \n",
       "28       青海省   13.30   12.98   11.90   11.19    6.57   6.16  15.26  11.84   \n",
       "29   宁夏回族自治区   19.93   21.87   21.09   17.91   12.26  10.85   6.96   9.89   \n",
       "30  新疆维吾尔自治区   44.78   44.83   38.09   26.27   17.44  13.47  10.45   8.66   \n",
       "\n",
       "    2007年  2006年  \n",
       "0   43.38  38.38  \n",
       "1   12.01   9.26  \n",
       "2    4.84   3.80  \n",
       "3    6.53   5.07  \n",
       "4    3.05   1.84  \n",
       "5    5.41   5.35  \n",
       "6    2.69   2.99  \n",
       "7    2.36   2.30  \n",
       "8   27.75  23.65  \n",
       "9   26.09  15.59  \n",
       "10   5.06   2.30  \n",
       "11   4.79   3.08  \n",
       "12   0.08   0.01  \n",
       "13   0.35   0.23  \n",
       "14  14.26  12.94  \n",
       "15   8.52   7.65  \n",
       "16   7.62   3.50  \n",
       "17   5.32   2.44  \n",
       "18   4.14   2.87  \n",
       "19   0.23   0.12  \n",
       "20   1.39   1.09  \n",
       "21  17.51  17.39  \n",
       "22  62.99  47.81  \n",
       "23   0.14   0.07  \n",
       "24   0.08   0.07  \n",
       "25    NaN   0.00  \n",
       "26  10.80   9.91  \n",
       "27   4.70   4.09  \n",
       "28  10.38   7.59  \n",
       "29   9.08   7.80  \n",
       "30   7.06   5.60  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df    = pd.read_table(\"pre_gas.csv\",   \n",
    "                       encoding = 'utf8',       \n",
    "                       skiprows = [32],      \n",
    "                       sep =','                \n",
    "                     )\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "df_gas    = pd.read_table(\"pre_gas.csv\",   \n",
    "                       encoding = 'utf8',       \n",
    "                       skiprows = [32],      \n",
    "                       sep =','                \n",
    "                     )\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "df_coal    = pd.read_table(\"pre_coal.csv\",   \n",
    "                       encoding = 'utf8',       \n",
    "                       skiprows = [32],      \n",
    "                       sep =','                \n",
    "                     )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "df = df_gas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['地区', '2015年', '2014年', '2013年', '2012年', '2011年', '2010年', '2009年',\n",
       "       '2008年', '2007年', '2006年'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "RangeIndex(start=0, stop=31, step=1)"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.index"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0       北京市\n",
       "1       天津市\n",
       "2       河北省\n",
       "3       山西省\n",
       "4    内蒙古自治区\n",
       "Name: 地区, dtype: object"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['地区'].head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "地区        object\n",
       "2015年    float64\n",
       "2014年    float64\n",
       "2013年    float64\n",
       "2012年    float64\n",
       "2011年    float64\n",
       "2010年    float64\n",
       "2009年    float64\n",
       "2008年    float64\n",
       "2007年    float64\n",
       "2006年    float64\n",
       "dtype: object"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['地区', 2015, 2014, 2013, 2012, 2011, 2010, 2009, 2008, 2007, 2006], dtype='object')"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.columns = [ int(x.replace('年','')) if x!='地区' else x for x in df.columns]\n",
    "df.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2015"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "years = [ x for x in df.columns if x!='地区'] \n",
    "max(years)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "df_melted = pd.melt(df, id_vars=['地区'], value_vars=years)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['地区', 'variable', 'value'], dtype='object')"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_melted.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>地区</th>\n",
       "      <th>年</th>\n",
       "      <th>gas</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>北京市</td>\n",
       "      <td>2015</td>\n",
       "      <td>144.49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>天津市</td>\n",
       "      <td>2015</td>\n",
       "      <td>30.66</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>河北省</td>\n",
       "      <td>2015</td>\n",
       "      <td>31.42</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>山西省</td>\n",
       "      <td>2015</td>\n",
       "      <td>24.74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>内蒙古自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>13.32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>辽宁省</td>\n",
       "      <td>2015</td>\n",
       "      <td>17.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>吉林省</td>\n",
       "      <td>2015</td>\n",
       "      <td>11.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>黑龙江省</td>\n",
       "      <td>2015</td>\n",
       "      <td>11.32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>上海市</td>\n",
       "      <td>2015</td>\n",
       "      <td>73.48</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>江苏省</td>\n",
       "      <td>2015</td>\n",
       "      <td>96.98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>浙江省</td>\n",
       "      <td>2015</td>\n",
       "      <td>31.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>安徽省</td>\n",
       "      <td>2015</td>\n",
       "      <td>23.46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>福建省</td>\n",
       "      <td>2015</td>\n",
       "      <td>14.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>江西省</td>\n",
       "      <td>2015</td>\n",
       "      <td>7.36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>山东省</td>\n",
       "      <td>2015</td>\n",
       "      <td>63.39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>河南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>33.28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>湖北省</td>\n",
       "      <td>2015</td>\n",
       "      <td>33.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>湖南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>21.55</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>广东省</td>\n",
       "      <td>2015</td>\n",
       "      <td>123.29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>广西壮族自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>3.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>海南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>2.90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>重庆市</td>\n",
       "      <td>2015</td>\n",
       "      <td>34.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>四川省</td>\n",
       "      <td>2015</td>\n",
       "      <td>62.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>贵州省</td>\n",
       "      <td>2015</td>\n",
       "      <td>3.29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>云南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>0.73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>西藏自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>0.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>陕西省</td>\n",
       "      <td>2015</td>\n",
       "      <td>31.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>甘肃省</td>\n",
       "      <td>2015</td>\n",
       "      <td>16.19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>青海省</td>\n",
       "      <td>2015</td>\n",
       "      <td>13.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>宁夏回族自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>19.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>280</th>\n",
       "      <td>天津市</td>\n",
       "      <td>2006</td>\n",
       "      <td>9.26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>281</th>\n",
       "      <td>河北省</td>\n",
       "      <td>2006</td>\n",
       "      <td>3.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>282</th>\n",
       "      <td>山西省</td>\n",
       "      <td>2006</td>\n",
       "      <td>5.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>283</th>\n",
       "      <td>内蒙古自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>1.84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>284</th>\n",
       "      <td>辽宁省</td>\n",
       "      <td>2006</td>\n",
       "      <td>5.35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>285</th>\n",
       "      <td>吉林省</td>\n",
       "      <td>2006</td>\n",
       "      <td>2.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>286</th>\n",
       "      <td>黑龙江省</td>\n",
       "      <td>2006</td>\n",
       "      <td>2.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>287</th>\n",
       "      <td>上海市</td>\n",
       "      <td>2006</td>\n",
       "      <td>23.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>288</th>\n",
       "      <td>江苏省</td>\n",
       "      <td>2006</td>\n",
       "      <td>15.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>289</th>\n",
       "      <td>浙江省</td>\n",
       "      <td>2006</td>\n",
       "      <td>2.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>290</th>\n",
       "      <td>安徽省</td>\n",
       "      <td>2006</td>\n",
       "      <td>3.08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>291</th>\n",
       "      <td>福建省</td>\n",
       "      <td>2006</td>\n",
       "      <td>0.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>292</th>\n",
       "      <td>江西省</td>\n",
       "      <td>2006</td>\n",
       "      <td>0.23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>293</th>\n",
       "      <td>山东省</td>\n",
       "      <td>2006</td>\n",
       "      <td>12.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>294</th>\n",
       "      <td>河南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>7.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>295</th>\n",
       "      <td>湖北省</td>\n",
       "      <td>2006</td>\n",
       "      <td>3.50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>296</th>\n",
       "      <td>湖南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>2.44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>297</th>\n",
       "      <td>广东省</td>\n",
       "      <td>2006</td>\n",
       "      <td>2.87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>298</th>\n",
       "      <td>广西壮族自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>0.12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>299</th>\n",
       "      <td>海南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>1.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>300</th>\n",
       "      <td>重庆市</td>\n",
       "      <td>2006</td>\n",
       "      <td>17.39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>301</th>\n",
       "      <td>四川省</td>\n",
       "      <td>2006</td>\n",
       "      <td>47.81</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>302</th>\n",
       "      <td>贵州省</td>\n",
       "      <td>2006</td>\n",
       "      <td>0.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>303</th>\n",
       "      <td>云南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>0.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>304</th>\n",
       "      <td>西藏自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>305</th>\n",
       "      <td>陕西省</td>\n",
       "      <td>2006</td>\n",
       "      <td>9.91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>306</th>\n",
       "      <td>甘肃省</td>\n",
       "      <td>2006</td>\n",
       "      <td>4.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>307</th>\n",
       "      <td>青海省</td>\n",
       "      <td>2006</td>\n",
       "      <td>7.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>308</th>\n",
       "      <td>宁夏回族自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>7.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>309</th>\n",
       "      <td>新疆维吾尔自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>5.60</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>310 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           地区     年     gas\n",
       "0         北京市  2015  144.49\n",
       "1         天津市  2015   30.66\n",
       "2         河北省  2015   31.42\n",
       "3         山西省  2015   24.74\n",
       "4      内蒙古自治区  2015   13.32\n",
       "5         辽宁省  2015   17.04\n",
       "6         吉林省  2015   11.14\n",
       "7        黑龙江省  2015   11.32\n",
       "8         上海市  2015   73.48\n",
       "9         江苏省  2015   96.98\n",
       "10        浙江省  2015   31.93\n",
       "11        安徽省  2015   23.46\n",
       "12        福建省  2015   14.88\n",
       "13        江西省  2015    7.36\n",
       "14        山东省  2015   63.39\n",
       "15        河南省  2015   33.28\n",
       "16        湖北省  2015   33.04\n",
       "17        湖南省  2015   21.55\n",
       "18        广东省  2015  123.29\n",
       "19    广西壮族自治区  2015    3.88\n",
       "20        海南省  2015    2.90\n",
       "21        重庆市  2015   34.94\n",
       "22        四川省  2015   62.80\n",
       "23        贵州省  2015    3.29\n",
       "24        云南省  2015    0.73\n",
       "25      西藏自治区  2015    0.13\n",
       "26        陕西省  2015   31.13\n",
       "27        甘肃省  2015   16.19\n",
       "28        青海省  2015   13.30\n",
       "29    宁夏回族自治区  2015   19.93\n",
       "..        ...   ...     ...\n",
       "280       天津市  2006    9.26\n",
       "281       河北省  2006    3.80\n",
       "282       山西省  2006    5.07\n",
       "283    内蒙古自治区  2006    1.84\n",
       "284       辽宁省  2006    5.35\n",
       "285       吉林省  2006    2.99\n",
       "286      黑龙江省  2006    2.30\n",
       "287       上海市  2006   23.65\n",
       "288       江苏省  2006   15.59\n",
       "289       浙江省  2006    2.30\n",
       "290       安徽省  2006    3.08\n",
       "291       福建省  2006    0.01\n",
       "292       江西省  2006    0.23\n",
       "293       山东省  2006   12.94\n",
       "294       河南省  2006    7.65\n",
       "295       湖北省  2006    3.50\n",
       "296       湖南省  2006    2.44\n",
       "297       广东省  2006    2.87\n",
       "298   广西壮族自治区  2006    0.12\n",
       "299       海南省  2006    1.09\n",
       "300       重庆市  2006   17.39\n",
       "301       四川省  2006   47.81\n",
       "302       贵州省  2006    0.07\n",
       "303       云南省  2006    0.07\n",
       "304     西藏自治区  2006    0.00\n",
       "305       陕西省  2006    9.91\n",
       "306       甘肃省  2006    4.09\n",
       "307       青海省  2006    7.59\n",
       "308   宁夏回族自治区  2006    7.80\n",
       "309  新疆维吾尔自治区  2006    5.60\n",
       "\n",
       "[310 rows x 3 columns]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_melted.columns = ['地区', '年', 'gas']\n",
    "df_melted"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "df_gas_done = df_melted"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>地区</th>\n",
       "      <th>年</th>\n",
       "      <th>coal</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>北京市</td>\n",
       "      <td>2015</td>\n",
       "      <td>1165.18</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>天津市</td>\n",
       "      <td>2015</td>\n",
       "      <td>4538.83</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>河北省</td>\n",
       "      <td>2015</td>\n",
       "      <td>28943.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>山西省</td>\n",
       "      <td>2015</td>\n",
       "      <td>37115.10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>内蒙古自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>36499.76</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>辽宁省</td>\n",
       "      <td>2015</td>\n",
       "      <td>17336.36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>吉林省</td>\n",
       "      <td>2015</td>\n",
       "      <td>9805.31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>黑龙江省</td>\n",
       "      <td>2015</td>\n",
       "      <td>13432.85</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>上海市</td>\n",
       "      <td>2015</td>\n",
       "      <td>4728.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>江苏省</td>\n",
       "      <td>2015</td>\n",
       "      <td>27209.12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>浙江省</td>\n",
       "      <td>2015</td>\n",
       "      <td>13826.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>安徽省</td>\n",
       "      <td>2015</td>\n",
       "      <td>15671.32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>福建省</td>\n",
       "      <td>2015</td>\n",
       "      <td>7659.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>江西省</td>\n",
       "      <td>2015</td>\n",
       "      <td>7698.24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>山东省</td>\n",
       "      <td>2015</td>\n",
       "      <td>40926.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>河南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>23719.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>湖北省</td>\n",
       "      <td>2015</td>\n",
       "      <td>11765.91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>湖南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>11142.26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>广东省</td>\n",
       "      <td>2015</td>\n",
       "      <td>16587.32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>广西壮族自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>6046.71</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>海南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>1071.92</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>重庆市</td>\n",
       "      <td>2015</td>\n",
       "      <td>6047.19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>四川省</td>\n",
       "      <td>2015</td>\n",
       "      <td>9288.90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>贵州省</td>\n",
       "      <td>2015</td>\n",
       "      <td>12833.49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>云南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>7712.85</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>西藏自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>陕西省</td>\n",
       "      <td>2015</td>\n",
       "      <td>18373.61</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>甘肃省</td>\n",
       "      <td>2015</td>\n",
       "      <td>6557.06</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>青海省</td>\n",
       "      <td>2015</td>\n",
       "      <td>1508.12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>宁夏回族自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>8907.37</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>280</th>\n",
       "      <td>天津市</td>\n",
       "      <td>2006</td>\n",
       "      <td>3809.31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>281</th>\n",
       "      <td>河北省</td>\n",
       "      <td>2006</td>\n",
       "      <td>21345.42</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>282</th>\n",
       "      <td>山西省</td>\n",
       "      <td>2006</td>\n",
       "      <td>28351.22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>283</th>\n",
       "      <td>内蒙古自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>16188.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>284</th>\n",
       "      <td>辽宁省</td>\n",
       "      <td>2006</td>\n",
       "      <td>14211.31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>285</th>\n",
       "      <td>吉林省</td>\n",
       "      <td>2006</td>\n",
       "      <td>7548.83</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>286</th>\n",
       "      <td>黑龙江省</td>\n",
       "      <td>2006</td>\n",
       "      <td>9025.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>287</th>\n",
       "      <td>上海市</td>\n",
       "      <td>2006</td>\n",
       "      <td>5143.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>288</th>\n",
       "      <td>江苏省</td>\n",
       "      <td>2006</td>\n",
       "      <td>18427.68</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>289</th>\n",
       "      <td>浙江省</td>\n",
       "      <td>2006</td>\n",
       "      <td>11334.43</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>290</th>\n",
       "      <td>安徽省</td>\n",
       "      <td>2006</td>\n",
       "      <td>8830.52</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>291</th>\n",
       "      <td>福建省</td>\n",
       "      <td>2006</td>\n",
       "      <td>5395.08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>292</th>\n",
       "      <td>江西省</td>\n",
       "      <td>2006</td>\n",
       "      <td>4592.26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>293</th>\n",
       "      <td>山东省</td>\n",
       "      <td>2006</td>\n",
       "      <td>29001.25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>294</th>\n",
       "      <td>河南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>21002.82</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>295</th>\n",
       "      <td>湖北省</td>\n",
       "      <td>2006</td>\n",
       "      <td>9651.64</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>296</th>\n",
       "      <td>湖南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>9438.51</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>297</th>\n",
       "      <td>广东省</td>\n",
       "      <td>2006</td>\n",
       "      <td>11125.98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>298</th>\n",
       "      <td>广西壮族自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>4172.86</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>299</th>\n",
       "      <td>海南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>332.23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>300</th>\n",
       "      <td>重庆市</td>\n",
       "      <td>2006</td>\n",
       "      <td>3734.60</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>301</th>\n",
       "      <td>四川省</td>\n",
       "      <td>2006</td>\n",
       "      <td>8532.71</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>302</th>\n",
       "      <td>贵州省</td>\n",
       "      <td>2006</td>\n",
       "      <td>9938.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>303</th>\n",
       "      <td>云南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>7482.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>304</th>\n",
       "      <td>西藏自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>305</th>\n",
       "      <td>陕西省</td>\n",
       "      <td>2006</td>\n",
       "      <td>7400.10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>306</th>\n",
       "      <td>甘肃省</td>\n",
       "      <td>2006</td>\n",
       "      <td>3959.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>307</th>\n",
       "      <td>青海省</td>\n",
       "      <td>2006</td>\n",
       "      <td>912.39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>308</th>\n",
       "      <td>宁夏回族自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>3489.61</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>309</th>\n",
       "      <td>新疆维吾尔自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>4436.21</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>310 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           地区     年      coal\n",
       "0         北京市  2015   1165.18\n",
       "1         天津市  2015   4538.83\n",
       "2         河北省  2015  28943.13\n",
       "3         山西省  2015  37115.10\n",
       "4      内蒙古自治区  2015  36499.76\n",
       "5         辽宁省  2015  17336.36\n",
       "6         吉林省  2015   9805.31\n",
       "7        黑龙江省  2015  13432.85\n",
       "8         上海市  2015   4728.13\n",
       "9         江苏省  2015  27209.12\n",
       "10        浙江省  2015  13826.07\n",
       "11        安徽省  2015  15671.32\n",
       "12        福建省  2015   7659.94\n",
       "13        江西省  2015   7698.24\n",
       "14        山东省  2015  40926.94\n",
       "15        河南省  2015  23719.94\n",
       "16        湖北省  2015  11765.91\n",
       "17        湖南省  2015  11142.26\n",
       "18        广东省  2015  16587.32\n",
       "19    广西壮族自治区  2015   6046.71\n",
       "20        海南省  2015   1071.92\n",
       "21        重庆市  2015   6047.19\n",
       "22        四川省  2015   9288.90\n",
       "23        贵州省  2015  12833.49\n",
       "24        云南省  2015   7712.85\n",
       "25      西藏自治区  2015       NaN\n",
       "26        陕西省  2015  18373.61\n",
       "27        甘肃省  2015   6557.06\n",
       "28        青海省  2015   1508.12\n",
       "29    宁夏回族自治区  2015   8907.37\n",
       "..        ...   ...       ...\n",
       "280       天津市  2006   3809.31\n",
       "281       河北省  2006  21345.42\n",
       "282       山西省  2006  28351.22\n",
       "283    内蒙古自治区  2006  16188.88\n",
       "284       辽宁省  2006  14211.31\n",
       "285       吉林省  2006   7548.83\n",
       "286      黑龙江省  2006   9025.04\n",
       "287       上海市  2006   5143.09\n",
       "288       江苏省  2006  18427.68\n",
       "289       浙江省  2006  11334.43\n",
       "290       安徽省  2006   8830.52\n",
       "291       福建省  2006   5395.08\n",
       "292       江西省  2006   4592.26\n",
       "293       山东省  2006  29001.25\n",
       "294       河南省  2006  21002.82\n",
       "295       湖北省  2006   9651.64\n",
       "296       湖南省  2006   9438.51\n",
       "297       广东省  2006  11125.98\n",
       "298   广西壮族自治区  2006   4172.86\n",
       "299       海南省  2006    332.23\n",
       "300       重庆市  2006   3734.60\n",
       "301       四川省  2006   8532.71\n",
       "302       贵州省  2006   9938.99\n",
       "303       云南省  2006   7482.00\n",
       "304     西藏自治区  2006       NaN\n",
       "305       陕西省  2006   7400.10\n",
       "306       甘肃省  2006   3959.09\n",
       "307       青海省  2006    912.39\n",
       "308   宁夏回族自治区  2006   3489.61\n",
       "309  新疆维吾尔自治区  2006   4436.21\n",
       "\n",
       "[310 rows x 3 columns]"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = df_coal\n",
    "df.columns = [ int(x.replace('年','')) if x!='地区' else x for x in df.columns]\n",
    "years = [ x for x in df.columns if x!='地区'] \n",
    "df_melted = pd.melt(df, id_vars=['地区'], value_vars=years)\n",
    "df_melted.columns = ['地区', '年', 'coal']\n",
    "df_coal_done = df_melted\n",
    "df_coal_done"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>地区</th>\n",
       "      <th>年</th>\n",
       "      <th>coal</th>\n",
       "      <th>地区_gas</th>\n",
       "      <th>年_gas</th>\n",
       "      <th>gas</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>北京市</td>\n",
       "      <td>2015</td>\n",
       "      <td>1165.18</td>\n",
       "      <td>北京市</td>\n",
       "      <td>2015</td>\n",
       "      <td>144.49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>天津市</td>\n",
       "      <td>2015</td>\n",
       "      <td>4538.83</td>\n",
       "      <td>天津市</td>\n",
       "      <td>2015</td>\n",
       "      <td>30.66</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>河北省</td>\n",
       "      <td>2015</td>\n",
       "      <td>28943.13</td>\n",
       "      <td>河北省</td>\n",
       "      <td>2015</td>\n",
       "      <td>31.42</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>山西省</td>\n",
       "      <td>2015</td>\n",
       "      <td>37115.10</td>\n",
       "      <td>山西省</td>\n",
       "      <td>2015</td>\n",
       "      <td>24.74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>内蒙古自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>36499.76</td>\n",
       "      <td>内蒙古自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>13.32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>辽宁省</td>\n",
       "      <td>2015</td>\n",
       "      <td>17336.36</td>\n",
       "      <td>辽宁省</td>\n",
       "      <td>2015</td>\n",
       "      <td>17.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>吉林省</td>\n",
       "      <td>2015</td>\n",
       "      <td>9805.31</td>\n",
       "      <td>吉林省</td>\n",
       "      <td>2015</td>\n",
       "      <td>11.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>黑龙江省</td>\n",
       "      <td>2015</td>\n",
       "      <td>13432.85</td>\n",
       "      <td>黑龙江省</td>\n",
       "      <td>2015</td>\n",
       "      <td>11.32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>上海市</td>\n",
       "      <td>2015</td>\n",
       "      <td>4728.13</td>\n",
       "      <td>上海市</td>\n",
       "      <td>2015</td>\n",
       "      <td>73.48</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>江苏省</td>\n",
       "      <td>2015</td>\n",
       "      <td>27209.12</td>\n",
       "      <td>江苏省</td>\n",
       "      <td>2015</td>\n",
       "      <td>96.98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>浙江省</td>\n",
       "      <td>2015</td>\n",
       "      <td>13826.07</td>\n",
       "      <td>浙江省</td>\n",
       "      <td>2015</td>\n",
       "      <td>31.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>安徽省</td>\n",
       "      <td>2015</td>\n",
       "      <td>15671.32</td>\n",
       "      <td>安徽省</td>\n",
       "      <td>2015</td>\n",
       "      <td>23.46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>福建省</td>\n",
       "      <td>2015</td>\n",
       "      <td>7659.94</td>\n",
       "      <td>福建省</td>\n",
       "      <td>2015</td>\n",
       "      <td>14.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>江西省</td>\n",
       "      <td>2015</td>\n",
       "      <td>7698.24</td>\n",
       "      <td>江西省</td>\n",
       "      <td>2015</td>\n",
       "      <td>7.36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>山东省</td>\n",
       "      <td>2015</td>\n",
       "      <td>40926.94</td>\n",
       "      <td>山东省</td>\n",
       "      <td>2015</td>\n",
       "      <td>63.39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>河南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>23719.94</td>\n",
       "      <td>河南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>33.28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>湖北省</td>\n",
       "      <td>2015</td>\n",
       "      <td>11765.91</td>\n",
       "      <td>湖北省</td>\n",
       "      <td>2015</td>\n",
       "      <td>33.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>湖南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>11142.26</td>\n",
       "      <td>湖南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>21.55</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>广东省</td>\n",
       "      <td>2015</td>\n",
       "      <td>16587.32</td>\n",
       "      <td>广东省</td>\n",
       "      <td>2015</td>\n",
       "      <td>123.29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>广西壮族自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>6046.71</td>\n",
       "      <td>广西壮族自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>3.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>海南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>1071.92</td>\n",
       "      <td>海南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>2.90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>重庆市</td>\n",
       "      <td>2015</td>\n",
       "      <td>6047.19</td>\n",
       "      <td>重庆市</td>\n",
       "      <td>2015</td>\n",
       "      <td>34.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>四川省</td>\n",
       "      <td>2015</td>\n",
       "      <td>9288.90</td>\n",
       "      <td>四川省</td>\n",
       "      <td>2015</td>\n",
       "      <td>62.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>贵州省</td>\n",
       "      <td>2015</td>\n",
       "      <td>12833.49</td>\n",
       "      <td>贵州省</td>\n",
       "      <td>2015</td>\n",
       "      <td>3.29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>云南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>7712.85</td>\n",
       "      <td>云南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>0.73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>西藏自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>NaN</td>\n",
       "      <td>西藏自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>0.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>陕西省</td>\n",
       "      <td>2015</td>\n",
       "      <td>18373.61</td>\n",
       "      <td>陕西省</td>\n",
       "      <td>2015</td>\n",
       "      <td>31.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>甘肃省</td>\n",
       "      <td>2015</td>\n",
       "      <td>6557.06</td>\n",
       "      <td>甘肃省</td>\n",
       "      <td>2015</td>\n",
       "      <td>16.19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>青海省</td>\n",
       "      <td>2015</td>\n",
       "      <td>1508.12</td>\n",
       "      <td>青海省</td>\n",
       "      <td>2015</td>\n",
       "      <td>13.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>宁夏回族自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>8907.37</td>\n",
       "      <td>宁夏回族自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>19.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>280</th>\n",
       "      <td>天津市</td>\n",
       "      <td>2006</td>\n",
       "      <td>3809.31</td>\n",
       "      <td>天津市</td>\n",
       "      <td>2006</td>\n",
       "      <td>9.26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>281</th>\n",
       "      <td>河北省</td>\n",
       "      <td>2006</td>\n",
       "      <td>21345.42</td>\n",
       "      <td>河北省</td>\n",
       "      <td>2006</td>\n",
       "      <td>3.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>282</th>\n",
       "      <td>山西省</td>\n",
       "      <td>2006</td>\n",
       "      <td>28351.22</td>\n",
       "      <td>山西省</td>\n",
       "      <td>2006</td>\n",
       "      <td>5.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>283</th>\n",
       "      <td>内蒙古自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>16188.88</td>\n",
       "      <td>内蒙古自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>1.84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>284</th>\n",
       "      <td>辽宁省</td>\n",
       "      <td>2006</td>\n",
       "      <td>14211.31</td>\n",
       "      <td>辽宁省</td>\n",
       "      <td>2006</td>\n",
       "      <td>5.35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>285</th>\n",
       "      <td>吉林省</td>\n",
       "      <td>2006</td>\n",
       "      <td>7548.83</td>\n",
       "      <td>吉林省</td>\n",
       "      <td>2006</td>\n",
       "      <td>2.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>286</th>\n",
       "      <td>黑龙江省</td>\n",
       "      <td>2006</td>\n",
       "      <td>9025.04</td>\n",
       "      <td>黑龙江省</td>\n",
       "      <td>2006</td>\n",
       "      <td>2.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>287</th>\n",
       "      <td>上海市</td>\n",
       "      <td>2006</td>\n",
       "      <td>5143.09</td>\n",
       "      <td>上海市</td>\n",
       "      <td>2006</td>\n",
       "      <td>23.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>288</th>\n",
       "      <td>江苏省</td>\n",
       "      <td>2006</td>\n",
       "      <td>18427.68</td>\n",
       "      <td>江苏省</td>\n",
       "      <td>2006</td>\n",
       "      <td>15.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>289</th>\n",
       "      <td>浙江省</td>\n",
       "      <td>2006</td>\n",
       "      <td>11334.43</td>\n",
       "      <td>浙江省</td>\n",
       "      <td>2006</td>\n",
       "      <td>2.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>290</th>\n",
       "      <td>安徽省</td>\n",
       "      <td>2006</td>\n",
       "      <td>8830.52</td>\n",
       "      <td>安徽省</td>\n",
       "      <td>2006</td>\n",
       "      <td>3.08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>291</th>\n",
       "      <td>福建省</td>\n",
       "      <td>2006</td>\n",
       "      <td>5395.08</td>\n",
       "      <td>福建省</td>\n",
       "      <td>2006</td>\n",
       "      <td>0.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>292</th>\n",
       "      <td>江西省</td>\n",
       "      <td>2006</td>\n",
       "      <td>4592.26</td>\n",
       "      <td>江西省</td>\n",
       "      <td>2006</td>\n",
       "      <td>0.23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>293</th>\n",
       "      <td>山东省</td>\n",
       "      <td>2006</td>\n",
       "      <td>29001.25</td>\n",
       "      <td>山东省</td>\n",
       "      <td>2006</td>\n",
       "      <td>12.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>294</th>\n",
       "      <td>河南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>21002.82</td>\n",
       "      <td>河南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>7.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>295</th>\n",
       "      <td>湖北省</td>\n",
       "      <td>2006</td>\n",
       "      <td>9651.64</td>\n",
       "      <td>湖北省</td>\n",
       "      <td>2006</td>\n",
       "      <td>3.50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>296</th>\n",
       "      <td>湖南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>9438.51</td>\n",
       "      <td>湖南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>2.44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>297</th>\n",
       "      <td>广东省</td>\n",
       "      <td>2006</td>\n",
       "      <td>11125.98</td>\n",
       "      <td>广东省</td>\n",
       "      <td>2006</td>\n",
       "      <td>2.87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>298</th>\n",
       "      <td>广西壮族自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>4172.86</td>\n",
       "      <td>广西壮族自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>0.12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>299</th>\n",
       "      <td>海南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>332.23</td>\n",
       "      <td>海南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>1.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>300</th>\n",
       "      <td>重庆市</td>\n",
       "      <td>2006</td>\n",
       "      <td>3734.60</td>\n",
       "      <td>重庆市</td>\n",
       "      <td>2006</td>\n",
       "      <td>17.39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>301</th>\n",
       "      <td>四川省</td>\n",
       "      <td>2006</td>\n",
       "      <td>8532.71</td>\n",
       "      <td>四川省</td>\n",
       "      <td>2006</td>\n",
       "      <td>47.81</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>302</th>\n",
       "      <td>贵州省</td>\n",
       "      <td>2006</td>\n",
       "      <td>9938.99</td>\n",
       "      <td>贵州省</td>\n",
       "      <td>2006</td>\n",
       "      <td>0.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>303</th>\n",
       "      <td>云南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>7482.00</td>\n",
       "      <td>云南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>0.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>304</th>\n",
       "      <td>西藏自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>NaN</td>\n",
       "      <td>西藏自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>305</th>\n",
       "      <td>陕西省</td>\n",
       "      <td>2006</td>\n",
       "      <td>7400.10</td>\n",
       "      <td>陕西省</td>\n",
       "      <td>2006</td>\n",
       "      <td>9.91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>306</th>\n",
       "      <td>甘肃省</td>\n",
       "      <td>2006</td>\n",
       "      <td>3959.09</td>\n",
       "      <td>甘肃省</td>\n",
       "      <td>2006</td>\n",
       "      <td>4.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>307</th>\n",
       "      <td>青海省</td>\n",
       "      <td>2006</td>\n",
       "      <td>912.39</td>\n",
       "      <td>青海省</td>\n",
       "      <td>2006</td>\n",
       "      <td>7.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>308</th>\n",
       "      <td>宁夏回族自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>3489.61</td>\n",
       "      <td>宁夏回族自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>7.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>309</th>\n",
       "      <td>新疆维吾尔自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>4436.21</td>\n",
       "      <td>新疆维吾尔自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>5.60</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>310 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           地区     年      coal    地区_gas 年_gas     gas\n",
       "0         北京市  2015   1165.18       北京市  2015  144.49\n",
       "1         天津市  2015   4538.83       天津市  2015   30.66\n",
       "2         河北省  2015  28943.13       河北省  2015   31.42\n",
       "3         山西省  2015  37115.10       山西省  2015   24.74\n",
       "4      内蒙古自治区  2015  36499.76    内蒙古自治区  2015   13.32\n",
       "5         辽宁省  2015  17336.36       辽宁省  2015   17.04\n",
       "6         吉林省  2015   9805.31       吉林省  2015   11.14\n",
       "7        黑龙江省  2015  13432.85      黑龙江省  2015   11.32\n",
       "8         上海市  2015   4728.13       上海市  2015   73.48\n",
       "9         江苏省  2015  27209.12       江苏省  2015   96.98\n",
       "10        浙江省  2015  13826.07       浙江省  2015   31.93\n",
       "11        安徽省  2015  15671.32       安徽省  2015   23.46\n",
       "12        福建省  2015   7659.94       福建省  2015   14.88\n",
       "13        江西省  2015   7698.24       江西省  2015    7.36\n",
       "14        山东省  2015  40926.94       山东省  2015   63.39\n",
       "15        河南省  2015  23719.94       河南省  2015   33.28\n",
       "16        湖北省  2015  11765.91       湖北省  2015   33.04\n",
       "17        湖南省  2015  11142.26       湖南省  2015   21.55\n",
       "18        广东省  2015  16587.32       广东省  2015  123.29\n",
       "19    广西壮族自治区  2015   6046.71   广西壮族自治区  2015    3.88\n",
       "20        海南省  2015   1071.92       海南省  2015    2.90\n",
       "21        重庆市  2015   6047.19       重庆市  2015   34.94\n",
       "22        四川省  2015   9288.90       四川省  2015   62.80\n",
       "23        贵州省  2015  12833.49       贵州省  2015    3.29\n",
       "24        云南省  2015   7712.85       云南省  2015    0.73\n",
       "25      西藏自治区  2015       NaN     西藏自治区  2015    0.13\n",
       "26        陕西省  2015  18373.61       陕西省  2015   31.13\n",
       "27        甘肃省  2015   6557.06       甘肃省  2015   16.19\n",
       "28        青海省  2015   1508.12       青海省  2015   13.30\n",
       "29    宁夏回族自治区  2015   8907.37   宁夏回族自治区  2015   19.93\n",
       "..        ...   ...       ...       ...   ...     ...\n",
       "280       天津市  2006   3809.31       天津市  2006    9.26\n",
       "281       河北省  2006  21345.42       河北省  2006    3.80\n",
       "282       山西省  2006  28351.22       山西省  2006    5.07\n",
       "283    内蒙古自治区  2006  16188.88    内蒙古自治区  2006    1.84\n",
       "284       辽宁省  2006  14211.31       辽宁省  2006    5.35\n",
       "285       吉林省  2006   7548.83       吉林省  2006    2.99\n",
       "286      黑龙江省  2006   9025.04      黑龙江省  2006    2.30\n",
       "287       上海市  2006   5143.09       上海市  2006   23.65\n",
       "288       江苏省  2006  18427.68       江苏省  2006   15.59\n",
       "289       浙江省  2006  11334.43       浙江省  2006    2.30\n",
       "290       安徽省  2006   8830.52       安徽省  2006    3.08\n",
       "291       福建省  2006   5395.08       福建省  2006    0.01\n",
       "292       江西省  2006   4592.26       江西省  2006    0.23\n",
       "293       山东省  2006  29001.25       山东省  2006   12.94\n",
       "294       河南省  2006  21002.82       河南省  2006    7.65\n",
       "295       湖北省  2006   9651.64       湖北省  2006    3.50\n",
       "296       湖南省  2006   9438.51       湖南省  2006    2.44\n",
       "297       广东省  2006  11125.98       广东省  2006    2.87\n",
       "298   广西壮族自治区  2006   4172.86   广西壮族自治区  2006    0.12\n",
       "299       海南省  2006    332.23       海南省  2006    1.09\n",
       "300       重庆市  2006   3734.60       重庆市  2006   17.39\n",
       "301       四川省  2006   8532.71       四川省  2006   47.81\n",
       "302       贵州省  2006   9938.99       贵州省  2006    0.07\n",
       "303       云南省  2006   7482.00       云南省  2006    0.07\n",
       "304     西藏自治区  2006       NaN     西藏自治区  2006    0.00\n",
       "305       陕西省  2006   7400.10       陕西省  2006    9.91\n",
       "306       甘肃省  2006   3959.09       甘肃省  2006    4.09\n",
       "307       青海省  2006    912.39       青海省  2006    7.59\n",
       "308   宁夏回族自治区  2006   3489.61   宁夏回族自治区  2006    7.80\n",
       "309  新疆维吾尔自治区  2006   4436.21  新疆维吾尔自治区  2006    5.60\n",
       "\n",
       "[310 rows x 6 columns]"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_p = df_coal_done.join(df_gas_done,lsuffix='', rsuffix='_gas')\n",
    "df_p"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>地区</th>\n",
       "      <th>年</th>\n",
       "      <th>coal</th>\n",
       "      <th>gas</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>北京市</td>\n",
       "      <td>2015</td>\n",
       "      <td>1165.18</td>\n",
       "      <td>144.49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>天津市</td>\n",
       "      <td>2015</td>\n",
       "      <td>4538.83</td>\n",
       "      <td>30.66</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>河北省</td>\n",
       "      <td>2015</td>\n",
       "      <td>28943.13</td>\n",
       "      <td>31.42</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>山西省</td>\n",
       "      <td>2015</td>\n",
       "      <td>37115.10</td>\n",
       "      <td>24.74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>内蒙古自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>36499.76</td>\n",
       "      <td>13.32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>辽宁省</td>\n",
       "      <td>2015</td>\n",
       "      <td>17336.36</td>\n",
       "      <td>17.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>吉林省</td>\n",
       "      <td>2015</td>\n",
       "      <td>9805.31</td>\n",
       "      <td>11.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>黑龙江省</td>\n",
       "      <td>2015</td>\n",
       "      <td>13432.85</td>\n",
       "      <td>11.32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>上海市</td>\n",
       "      <td>2015</td>\n",
       "      <td>4728.13</td>\n",
       "      <td>73.48</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>江苏省</td>\n",
       "      <td>2015</td>\n",
       "      <td>27209.12</td>\n",
       "      <td>96.98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>浙江省</td>\n",
       "      <td>2015</td>\n",
       "      <td>13826.07</td>\n",
       "      <td>31.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>安徽省</td>\n",
       "      <td>2015</td>\n",
       "      <td>15671.32</td>\n",
       "      <td>23.46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>福建省</td>\n",
       "      <td>2015</td>\n",
       "      <td>7659.94</td>\n",
       "      <td>14.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>江西省</td>\n",
       "      <td>2015</td>\n",
       "      <td>7698.24</td>\n",
       "      <td>7.36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>山东省</td>\n",
       "      <td>2015</td>\n",
       "      <td>40926.94</td>\n",
       "      <td>63.39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>河南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>23719.94</td>\n",
       "      <td>33.28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>湖北省</td>\n",
       "      <td>2015</td>\n",
       "      <td>11765.91</td>\n",
       "      <td>33.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>湖南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>11142.26</td>\n",
       "      <td>21.55</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>广东省</td>\n",
       "      <td>2015</td>\n",
       "      <td>16587.32</td>\n",
       "      <td>123.29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>广西壮族自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>6046.71</td>\n",
       "      <td>3.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>海南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>1071.92</td>\n",
       "      <td>2.90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>重庆市</td>\n",
       "      <td>2015</td>\n",
       "      <td>6047.19</td>\n",
       "      <td>34.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>四川省</td>\n",
       "      <td>2015</td>\n",
       "      <td>9288.90</td>\n",
       "      <td>62.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>贵州省</td>\n",
       "      <td>2015</td>\n",
       "      <td>12833.49</td>\n",
       "      <td>3.29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>云南省</td>\n",
       "      <td>2015</td>\n",
       "      <td>7712.85</td>\n",
       "      <td>0.73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>西藏自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>陕西省</td>\n",
       "      <td>2015</td>\n",
       "      <td>18373.61</td>\n",
       "      <td>31.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>甘肃省</td>\n",
       "      <td>2015</td>\n",
       "      <td>6557.06</td>\n",
       "      <td>16.19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>青海省</td>\n",
       "      <td>2015</td>\n",
       "      <td>1508.12</td>\n",
       "      <td>13.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>宁夏回族自治区</td>\n",
       "      <td>2015</td>\n",
       "      <td>8907.37</td>\n",
       "      <td>19.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>280</th>\n",
       "      <td>天津市</td>\n",
       "      <td>2006</td>\n",
       "      <td>3809.31</td>\n",
       "      <td>9.26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>281</th>\n",
       "      <td>河北省</td>\n",
       "      <td>2006</td>\n",
       "      <td>21345.42</td>\n",
       "      <td>3.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>282</th>\n",
       "      <td>山西省</td>\n",
       "      <td>2006</td>\n",
       "      <td>28351.22</td>\n",
       "      <td>5.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>283</th>\n",
       "      <td>内蒙古自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>16188.88</td>\n",
       "      <td>1.84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>284</th>\n",
       "      <td>辽宁省</td>\n",
       "      <td>2006</td>\n",
       "      <td>14211.31</td>\n",
       "      <td>5.35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>285</th>\n",
       "      <td>吉林省</td>\n",
       "      <td>2006</td>\n",
       "      <td>7548.83</td>\n",
       "      <td>2.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>286</th>\n",
       "      <td>黑龙江省</td>\n",
       "      <td>2006</td>\n",
       "      <td>9025.04</td>\n",
       "      <td>2.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>287</th>\n",
       "      <td>上海市</td>\n",
       "      <td>2006</td>\n",
       "      <td>5143.09</td>\n",
       "      <td>23.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>288</th>\n",
       "      <td>江苏省</td>\n",
       "      <td>2006</td>\n",
       "      <td>18427.68</td>\n",
       "      <td>15.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>289</th>\n",
       "      <td>浙江省</td>\n",
       "      <td>2006</td>\n",
       "      <td>11334.43</td>\n",
       "      <td>2.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>290</th>\n",
       "      <td>安徽省</td>\n",
       "      <td>2006</td>\n",
       "      <td>8830.52</td>\n",
       "      <td>3.08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>291</th>\n",
       "      <td>福建省</td>\n",
       "      <td>2006</td>\n",
       "      <td>5395.08</td>\n",
       "      <td>0.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>292</th>\n",
       "      <td>江西省</td>\n",
       "      <td>2006</td>\n",
       "      <td>4592.26</td>\n",
       "      <td>0.23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>293</th>\n",
       "      <td>山东省</td>\n",
       "      <td>2006</td>\n",
       "      <td>29001.25</td>\n",
       "      <td>12.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>294</th>\n",
       "      <td>河南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>21002.82</td>\n",
       "      <td>7.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>295</th>\n",
       "      <td>湖北省</td>\n",
       "      <td>2006</td>\n",
       "      <td>9651.64</td>\n",
       "      <td>3.50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>296</th>\n",
       "      <td>湖南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>9438.51</td>\n",
       "      <td>2.44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>297</th>\n",
       "      <td>广东省</td>\n",
       "      <td>2006</td>\n",
       "      <td>11125.98</td>\n",
       "      <td>2.87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>298</th>\n",
       "      <td>广西壮族自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>4172.86</td>\n",
       "      <td>0.12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>299</th>\n",
       "      <td>海南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>332.23</td>\n",
       "      <td>1.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>300</th>\n",
       "      <td>重庆市</td>\n",
       "      <td>2006</td>\n",
       "      <td>3734.60</td>\n",
       "      <td>17.39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>301</th>\n",
       "      <td>四川省</td>\n",
       "      <td>2006</td>\n",
       "      <td>8532.71</td>\n",
       "      <td>47.81</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>302</th>\n",
       "      <td>贵州省</td>\n",
       "      <td>2006</td>\n",
       "      <td>9938.99</td>\n",
       "      <td>0.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>303</th>\n",
       "      <td>云南省</td>\n",
       "      <td>2006</td>\n",
       "      <td>7482.00</td>\n",
       "      <td>0.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>304</th>\n",
       "      <td>西藏自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>305</th>\n",
       "      <td>陕西省</td>\n",
       "      <td>2006</td>\n",
       "      <td>7400.10</td>\n",
       "      <td>9.91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>306</th>\n",
       "      <td>甘肃省</td>\n",
       "      <td>2006</td>\n",
       "      <td>3959.09</td>\n",
       "      <td>4.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>307</th>\n",
       "      <td>青海省</td>\n",
       "      <td>2006</td>\n",
       "      <td>912.39</td>\n",
       "      <td>7.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>308</th>\n",
       "      <td>宁夏回族自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>3489.61</td>\n",
       "      <td>7.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>309</th>\n",
       "      <td>新疆维吾尔自治区</td>\n",
       "      <td>2006</td>\n",
       "      <td>4436.21</td>\n",
       "      <td>5.60</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>310 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           地区     年      coal     gas\n",
       "0         北京市  2015   1165.18  144.49\n",
       "1         天津市  2015   4538.83   30.66\n",
       "2         河北省  2015  28943.13   31.42\n",
       "3         山西省  2015  37115.10   24.74\n",
       "4      内蒙古自治区  2015  36499.76   13.32\n",
       "5         辽宁省  2015  17336.36   17.04\n",
       "6         吉林省  2015   9805.31   11.14\n",
       "7        黑龙江省  2015  13432.85   11.32\n",
       "8         上海市  2015   4728.13   73.48\n",
       "9         江苏省  2015  27209.12   96.98\n",
       "10        浙江省  2015  13826.07   31.93\n",
       "11        安徽省  2015  15671.32   23.46\n",
       "12        福建省  2015   7659.94   14.88\n",
       "13        江西省  2015   7698.24    7.36\n",
       "14        山东省  2015  40926.94   63.39\n",
       "15        河南省  2015  23719.94   33.28\n",
       "16        湖北省  2015  11765.91   33.04\n",
       "17        湖南省  2015  11142.26   21.55\n",
       "18        广东省  2015  16587.32  123.29\n",
       "19    广西壮族自治区  2015   6046.71    3.88\n",
       "20        海南省  2015   1071.92    2.90\n",
       "21        重庆市  2015   6047.19   34.94\n",
       "22        四川省  2015   9288.90   62.80\n",
       "23        贵州省  2015  12833.49    3.29\n",
       "24        云南省  2015   7712.85    0.73\n",
       "25      西藏自治区  2015       NaN    0.13\n",
       "26        陕西省  2015  18373.61   31.13\n",
       "27        甘肃省  2015   6557.06   16.19\n",
       "28        青海省  2015   1508.12   13.30\n",
       "29    宁夏回族自治区  2015   8907.37   19.93\n",
       "..        ...   ...       ...     ...\n",
       "280       天津市  2006   3809.31    9.26\n",
       "281       河北省  2006  21345.42    3.80\n",
       "282       山西省  2006  28351.22    5.07\n",
       "283    内蒙古自治区  2006  16188.88    1.84\n",
       "284       辽宁省  2006  14211.31    5.35\n",
       "285       吉林省  2006   7548.83    2.99\n",
       "286      黑龙江省  2006   9025.04    2.30\n",
       "287       上海市  2006   5143.09   23.65\n",
       "288       江苏省  2006  18427.68   15.59\n",
       "289       浙江省  2006  11334.43    2.30\n",
       "290       安徽省  2006   8830.52    3.08\n",
       "291       福建省  2006   5395.08    0.01\n",
       "292       江西省  2006   4592.26    0.23\n",
       "293       山东省  2006  29001.25   12.94\n",
       "294       河南省  2006  21002.82    7.65\n",
       "295       湖北省  2006   9651.64    3.50\n",
       "296       湖南省  2006   9438.51    2.44\n",
       "297       广东省  2006  11125.98    2.87\n",
       "298   广西壮族自治区  2006   4172.86    0.12\n",
       "299       海南省  2006    332.23    1.09\n",
       "300       重庆市  2006   3734.60   17.39\n",
       "301       四川省  2006   8532.71   47.81\n",
       "302       贵州省  2006   9938.99    0.07\n",
       "303       云南省  2006   7482.00    0.07\n",
       "304     西藏自治区  2006       NaN    0.00\n",
       "305       陕西省  2006   7400.10    9.91\n",
       "306       甘肃省  2006   3959.09    4.09\n",
       "307       青海省  2006    912.39    7.59\n",
       "308   宁夏回族自治区  2006   3489.61    7.80\n",
       "309  新疆维吾尔自治区  2006   4436.21    5.60\n",
       "\n",
       "[310 rows x 4 columns]"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_p.drop([\"地区_gas\",\"年_gas\"], axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>coal</th>\n",
       "      <th>gas</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>地区</th>\n",
       "      <th>年</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>北京市</th>\n",
       "      <th>2015</th>\n",
       "      <td>1165.18</td>\n",
       "      <td>144.49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>天津市</th>\n",
       "      <th>2015</th>\n",
       "      <td>4538.83</td>\n",
       "      <td>30.66</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>河北省</th>\n",
       "      <th>2015</th>\n",
       "      <td>28943.13</td>\n",
       "      <td>31.42</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>山西省</th>\n",
       "      <th>2015</th>\n",
       "      <td>37115.10</td>\n",
       "      <td>24.74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>内蒙古自治区</th>\n",
       "      <th>2015</th>\n",
       "      <td>36499.76</td>\n",
       "      <td>13.32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>辽宁省</th>\n",
       "      <th>2015</th>\n",
       "      <td>17336.36</td>\n",
       "      <td>17.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>吉林省</th>\n",
       "      <th>2015</th>\n",
       "      <td>9805.31</td>\n",
       "      <td>11.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>黑龙江省</th>\n",
       "      <th>2015</th>\n",
       "      <td>13432.85</td>\n",
       "      <td>11.32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>上海市</th>\n",
       "      <th>2015</th>\n",
       "      <td>4728.13</td>\n",
       "      <td>73.48</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>江苏省</th>\n",
       "      <th>2015</th>\n",
       "      <td>27209.12</td>\n",
       "      <td>96.98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>浙江省</th>\n",
       "      <th>2015</th>\n",
       "      <td>13826.07</td>\n",
       "      <td>31.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>安徽省</th>\n",
       "      <th>2015</th>\n",
       "      <td>15671.32</td>\n",
       "      <td>23.46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>福建省</th>\n",
       "      <th>2015</th>\n",
       "      <td>7659.94</td>\n",
       "      <td>14.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>江西省</th>\n",
       "      <th>2015</th>\n",
       "      <td>7698.24</td>\n",
       "      <td>7.36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>山东省</th>\n",
       "      <th>2015</th>\n",
       "      <td>40926.94</td>\n",
       "      <td>63.39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>河南省</th>\n",
       "      <th>2015</th>\n",
       "      <td>23719.94</td>\n",
       "      <td>33.28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>湖北省</th>\n",
       "      <th>2015</th>\n",
       "      <td>11765.91</td>\n",
       "      <td>33.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>湖南省</th>\n",
       "      <th>2015</th>\n",
       "      <td>11142.26</td>\n",
       "      <td>21.55</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>广东省</th>\n",
       "      <th>2015</th>\n",
       "      <td>16587.32</td>\n",
       "      <td>123.29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>广西壮族自治区</th>\n",
       "      <th>2015</th>\n",
       "      <td>6046.71</td>\n",
       "      <td>3.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>海南省</th>\n",
       "      <th>2015</th>\n",
       "      <td>1071.92</td>\n",
       "      <td>2.90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>重庆市</th>\n",
       "      <th>2015</th>\n",
       "      <td>6047.19</td>\n",
       "      <td>34.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>四川省</th>\n",
       "      <th>2015</th>\n",
       "      <td>9288.90</td>\n",
       "      <td>62.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>贵州省</th>\n",
       "      <th>2015</th>\n",
       "      <td>12833.49</td>\n",
       "      <td>3.29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>云南省</th>\n",
       "      <th>2015</th>\n",
       "      <td>7712.85</td>\n",
       "      <td>0.73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>西藏自治区</th>\n",
       "      <th>2015</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>陕西省</th>\n",
       "      <th>2015</th>\n",
       "      <td>18373.61</td>\n",
       "      <td>31.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>甘肃省</th>\n",
       "      <th>2015</th>\n",
       "      <td>6557.06</td>\n",
       "      <td>16.19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>青海省</th>\n",
       "      <th>2015</th>\n",
       "      <td>1508.12</td>\n",
       "      <td>13.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>宁夏回族自治区</th>\n",
       "      <th>2015</th>\n",
       "      <td>8907.37</td>\n",
       "      <td>19.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>天津市</th>\n",
       "      <th>2006</th>\n",
       "      <td>3809.31</td>\n",
       "      <td>9.26</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>河北省</th>\n",
       "      <th>2006</th>\n",
       "      <td>21345.42</td>\n",
       "      <td>3.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>山西省</th>\n",
       "      <th>2006</th>\n",
       "      <td>28351.22</td>\n",
       "      <td>5.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>内蒙古自治区</th>\n",
       "      <th>2006</th>\n",
       "      <td>16188.88</td>\n",
       "      <td>1.84</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>辽宁省</th>\n",
       "      <th>2006</th>\n",
       "      <td>14211.31</td>\n",
       "      <td>5.35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>吉林省</th>\n",
       "      <th>2006</th>\n",
       "      <td>7548.83</td>\n",
       "      <td>2.99</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>黑龙江省</th>\n",
       "      <th>2006</th>\n",
       "      <td>9025.04</td>\n",
       "      <td>2.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>上海市</th>\n",
       "      <th>2006</th>\n",
       "      <td>5143.09</td>\n",
       "      <td>23.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>江苏省</th>\n",
       "      <th>2006</th>\n",
       "      <td>18427.68</td>\n",
       "      <td>15.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>浙江省</th>\n",
       "      <th>2006</th>\n",
       "      <td>11334.43</td>\n",
       "      <td>2.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>安徽省</th>\n",
       "      <th>2006</th>\n",
       "      <td>8830.52</td>\n",
       "      <td>3.08</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>福建省</th>\n",
       "      <th>2006</th>\n",
       "      <td>5395.08</td>\n",
       "      <td>0.01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>江西省</th>\n",
       "      <th>2006</th>\n",
       "      <td>4592.26</td>\n",
       "      <td>0.23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>山东省</th>\n",
       "      <th>2006</th>\n",
       "      <td>29001.25</td>\n",
       "      <td>12.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>河南省</th>\n",
       "      <th>2006</th>\n",
       "      <td>21002.82</td>\n",
       "      <td>7.65</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>湖北省</th>\n",
       "      <th>2006</th>\n",
       "      <td>9651.64</td>\n",
       "      <td>3.50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>湖南省</th>\n",
       "      <th>2006</th>\n",
       "      <td>9438.51</td>\n",
       "      <td>2.44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>广东省</th>\n",
       "      <th>2006</th>\n",
       "      <td>11125.98</td>\n",
       "      <td>2.87</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>广西壮族自治区</th>\n",
       "      <th>2006</th>\n",
       "      <td>4172.86</td>\n",
       "      <td>0.12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>海南省</th>\n",
       "      <th>2006</th>\n",
       "      <td>332.23</td>\n",
       "      <td>1.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>重庆市</th>\n",
       "      <th>2006</th>\n",
       "      <td>3734.60</td>\n",
       "      <td>17.39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>四川省</th>\n",
       "      <th>2006</th>\n",
       "      <td>8532.71</td>\n",
       "      <td>47.81</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>贵州省</th>\n",
       "      <th>2006</th>\n",
       "      <td>9938.99</td>\n",
       "      <td>0.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>云南省</th>\n",
       "      <th>2006</th>\n",
       "      <td>7482.00</td>\n",
       "      <td>0.07</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>西藏自治区</th>\n",
       "      <th>2006</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0.00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>陕西省</th>\n",
       "      <th>2006</th>\n",
       "      <td>7400.10</td>\n",
       "      <td>9.91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>甘肃省</th>\n",
       "      <th>2006</th>\n",
       "      <td>3959.09</td>\n",
       "      <td>4.09</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>青海省</th>\n",
       "      <th>2006</th>\n",
       "      <td>912.39</td>\n",
       "      <td>7.59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>宁夏回族自治区</th>\n",
       "      <th>2006</th>\n",
       "      <td>3489.61</td>\n",
       "      <td>7.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>新疆维吾尔自治区</th>\n",
       "      <th>2006</th>\n",
       "      <td>4436.21</td>\n",
       "      <td>5.60</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>310 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                   coal     gas\n",
       "地区       年                     \n",
       "北京市      2015   1165.18  144.49\n",
       "天津市      2015   4538.83   30.66\n",
       "河北省      2015  28943.13   31.42\n",
       "山西省      2015  37115.10   24.74\n",
       "内蒙古自治区   2015  36499.76   13.32\n",
       "辽宁省      2015  17336.36   17.04\n",
       "吉林省      2015   9805.31   11.14\n",
       "黑龙江省     2015  13432.85   11.32\n",
       "上海市      2015   4728.13   73.48\n",
       "江苏省      2015  27209.12   96.98\n",
       "浙江省      2015  13826.07   31.93\n",
       "安徽省      2015  15671.32   23.46\n",
       "福建省      2015   7659.94   14.88\n",
       "江西省      2015   7698.24    7.36\n",
       "山东省      2015  40926.94   63.39\n",
       "河南省      2015  23719.94   33.28\n",
       "湖北省      2015  11765.91   33.04\n",
       "湖南省      2015  11142.26   21.55\n",
       "广东省      2015  16587.32  123.29\n",
       "广西壮族自治区  2015   6046.71    3.88\n",
       "海南省      2015   1071.92    2.90\n",
       "重庆市      2015   6047.19   34.94\n",
       "四川省      2015   9288.90   62.80\n",
       "贵州省      2015  12833.49    3.29\n",
       "云南省      2015   7712.85    0.73\n",
       "西藏自治区    2015       NaN    0.13\n",
       "陕西省      2015  18373.61   31.13\n",
       "甘肃省      2015   6557.06   16.19\n",
       "青海省      2015   1508.12   13.30\n",
       "宁夏回族自治区  2015   8907.37   19.93\n",
       "...                 ...     ...\n",
       "天津市      2006   3809.31    9.26\n",
       "河北省      2006  21345.42    3.80\n",
       "山西省      2006  28351.22    5.07\n",
       "内蒙古自治区   2006  16188.88    1.84\n",
       "辽宁省      2006  14211.31    5.35\n",
       "吉林省      2006   7548.83    2.99\n",
       "黑龙江省     2006   9025.04    2.30\n",
       "上海市      2006   5143.09   23.65\n",
       "江苏省      2006  18427.68   15.59\n",
       "浙江省      2006  11334.43    2.30\n",
       "安徽省      2006   8830.52    3.08\n",
       "福建省      2006   5395.08    0.01\n",
       "江西省      2006   4592.26    0.23\n",
       "山东省      2006  29001.25   12.94\n",
       "河南省      2006  21002.82    7.65\n",
       "湖北省      2006   9651.64    3.50\n",
       "湖南省      2006   9438.51    2.44\n",
       "广东省      2006  11125.98    2.87\n",
       "广西壮族自治区  2006   4172.86    0.12\n",
       "海南省      2006    332.23    1.09\n",
       "重庆市      2006   3734.60   17.39\n",
       "四川省      2006   8532.71   47.81\n",
       "贵州省      2006   9938.99    0.07\n",
       "云南省      2006   7482.00    0.07\n",
       "西藏自治区    2006       NaN    0.00\n",
       "陕西省      2006   7400.10    9.91\n",
       "甘肃省      2006   3959.09    4.09\n",
       "青海省      2006    912.39    7.59\n",
       "宁夏回族自治区  2006   3489.61    7.80\n",
       "新疆维吾尔自治区 2006   4436.21    5.60\n",
       "\n",
       "[310 rows x 2 columns]"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_p.drop([\"地区_gas\",\"年_gas\"], axis=1).set_index([\"地区\",\"年\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "df_pp = df_p.drop([\"地区_gas\",\"年_gas\"], axis=1).set_index([\"地区\",\"年\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th>coal</th>\n",
       "      <th>gas</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>地区</th>\n",
       "      <th>年</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>北京市</th>\n",
       "      <th>2015</th>\n",
       "      <td>1165.18</td>\n",
       "      <td>144.49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>天津市</th>\n",
       "      <th>2015</th>\n",
       "      <td>4538.83</td>\n",
       "      <td>30.66</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>河北省</th>\n",
       "      <th>2015</th>\n",
       "      <td>28943.13</td>\n",
       "      <td>31.42</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>山西省</th>\n",
       "      <th>2015</th>\n",
       "      <td>37115.10</td>\n",
       "      <td>24.74</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>内蒙古自治区</th>\n",
       "      <th>2015</th>\n",
       "      <td>36499.76</td>\n",
       "      <td>13.32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>辽宁省</th>\n",
       "      <th>2015</th>\n",
       "      <td>17336.36</td>\n",
       "      <td>17.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>吉林省</th>\n",
       "      <th>2015</th>\n",
       "      <td>9805.31</td>\n",
       "      <td>11.14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>黑龙江省</th>\n",
       "      <th>2015</th>\n",
       "      <td>13432.85</td>\n",
       "      <td>11.32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>上海市</th>\n",
       "      <th>2015</th>\n",
       "      <td>4728.13</td>\n",
       "      <td>73.48</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>江苏省</th>\n",
       "      <th>2015</th>\n",
       "      <td>27209.12</td>\n",
       "      <td>96.98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>浙江省</th>\n",
       "      <th>2015</th>\n",
       "      <td>13826.07</td>\n",
       "      <td>31.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>安徽省</th>\n",
       "      <th>2015</th>\n",
       "      <td>15671.32</td>\n",
       "      <td>23.46</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>福建省</th>\n",
       "      <th>2015</th>\n",
       "      <td>7659.94</td>\n",
       "      <td>14.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>江西省</th>\n",
       "      <th>2015</th>\n",
       "      <td>7698.24</td>\n",
       "      <td>7.36</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>山东省</th>\n",
       "      <th>2015</th>\n",
       "      <td>40926.94</td>\n",
       "      <td>63.39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>河南省</th>\n",
       "      <th>2015</th>\n",
       "      <td>23719.94</td>\n",
       "      <td>33.28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>湖北省</th>\n",
       "      <th>2015</th>\n",
       "      <td>11765.91</td>\n",
       "      <td>33.04</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>湖南省</th>\n",
       "      <th>2015</th>\n",
       "      <td>11142.26</td>\n",
       "      <td>21.55</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>广东省</th>\n",
       "      <th>2015</th>\n",
       "      <td>16587.32</td>\n",
       "      <td>123.29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>广西壮族自治区</th>\n",
       "      <th>2015</th>\n",
       "      <td>6046.71</td>\n",
       "      <td>3.88</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>海南省</th>\n",
       "      <th>2015</th>\n",
       "      <td>1071.92</td>\n",
       "      <td>2.90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>重庆市</th>\n",
       "      <th>2015</th>\n",
       "      <td>6047.19</td>\n",
       "      <td>34.94</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>四川省</th>\n",
       "      <th>2015</th>\n",
       "      <td>9288.90</td>\n",
       "      <td>62.80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>贵州省</th>\n",
       "      <th>2015</th>\n",
       "      <td>12833.49</td>\n",
       "      <td>3.29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>云南省</th>\n",
       "      <th>2015</th>\n",
       "      <td>7712.85</td>\n",
       "      <td>0.73</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>西藏自治区</th>\n",
       "      <th>2015</th>\n",
       "      <td>NaN</td>\n",
       "      <td>0.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>陕西省</th>\n",
       "      <th>2015</th>\n",
       "      <td>18373.61</td>\n",
       "      <td>31.13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>甘肃省</th>\n",
       "      <th>2015</th>\n",
       "      <td>6557.06</td>\n",
       "      <td>16.19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>青海省</th>\n",
       "      <th>2015</th>\n",
       "      <td>1508.12</td>\n",
       "      <td>13.30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>宁夏回族自治区</th>\n",
       "      <th>2015</th>\n",
       "      <td>8907.37</td>\n",
       "      <td>19.93</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>新疆维吾尔自治区</th>\n",
       "      <th>2015</th>\n",
       "      <td>17359.28</td>\n",
       "      <td>44.78</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                   coal     gas\n",
       "地区       年                     \n",
       "北京市      2015   1165.18  144.49\n",
       "天津市      2015   4538.83   30.66\n",
       "河北省      2015  28943.13   31.42\n",
       "山西省      2015  37115.10   24.74\n",
       "内蒙古自治区   2015  36499.76   13.32\n",
       "辽宁省      2015  17336.36   17.04\n",
       "吉林省      2015   9805.31   11.14\n",
       "黑龙江省     2015  13432.85   11.32\n",
       "上海市      2015   4728.13   73.48\n",
       "江苏省      2015  27209.12   96.98\n",
       "浙江省      2015  13826.07   31.93\n",
       "安徽省      2015  15671.32   23.46\n",
       "福建省      2015   7659.94   14.88\n",
       "江西省      2015   7698.24    7.36\n",
       "山东省      2015  40926.94   63.39\n",
       "河南省      2015  23719.94   33.28\n",
       "湖北省      2015  11765.91   33.04\n",
       "湖南省      2015  11142.26   21.55\n",
       "广东省      2015  16587.32  123.29\n",
       "广西壮族自治区  2015   6046.71    3.88\n",
       "海南省      2015   1071.92    2.90\n",
       "重庆市      2015   6047.19   34.94\n",
       "四川省      2015   9288.90   62.80\n",
       "贵州省      2015  12833.49    3.29\n",
       "云南省      2015   7712.85    0.73\n",
       "西藏自治区    2015       NaN    0.13\n",
       "陕西省      2015  18373.61   31.13\n",
       "甘肃省      2015   6557.06   16.19\n",
       "青海省      2015   1508.12   13.30\n",
       "宁夏回族自治区  2015   8907.37   19.93\n",
       "新疆维吾尔自治区 2015  17359.28   44.78"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_pp.query(\"年==2015\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x19981ca1c50>"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x19981ca1240>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "%matplotlib inline\n",
    "df_pp.query(\"年==2015\").plot(kind='scatter', x='coal', y='gas', \n",
    "          title = 'coal与gas的发展趋势')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x1998202ecf8>"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x199820420b8>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib as mpl\n",
    "import matplotlib.pyplot as plt\n",
    "import pylab\n",
    "mpl.rcParams['font.sans-serif']=['SimHei']\n",
    "mpl.rcParams['axes.unicode_minus']=False\n",
    "\n",
    "df_plot = df_pp.query(\"年==2015\")\n",
    "df_plot.plot(kind='scatter', x='coal', y='gas', \n",
    "          title = 'coal与gas的发展趋势')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    " import numpy as np\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "ename": "ValueError",
     "evalue": "On entry to DGELSD parameter number 4 had an illegal value",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mValueError\u001b[0m                                Traceback (most recent call last)",
      "\u001b[1;32m<ipython-input-40-00f656776b38>\u001b[0m in \u001b[0;36m<module>\u001b[1;34m()\u001b[0m\n\u001b[1;32m----> 1\u001b[1;33m \u001b[0mfit\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mpolyfit\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mx\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mdf_pp\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mquery\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"年==2015\"\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'coal'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0my\u001b[0m\u001b[1;33m=\u001b[0m\u001b[0mdf_pp\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mquery\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m\"年==2015\"\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'gas'\u001b[0m\u001b[1;33m]\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mdeg\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;36m1\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m",
      "\u001b[1;32mD:\\python anaconda\\lib\\site-packages\\numpy\\lib\\polynomial.py\u001b[0m in \u001b[0;36mpolyfit\u001b[1;34m(x, y, deg, rcond, full, w, cov)\u001b[0m\n\u001b[0;32m    583\u001b[0m     \u001b[0mscale\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mNX\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0msqrt\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mlhs\u001b[0m\u001b[1;33m*\u001b[0m\u001b[0mlhs\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0msum\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0maxis\u001b[0m\u001b[1;33m=\u001b[0m\u001b[1;36m0\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    584\u001b[0m     \u001b[0mlhs\u001b[0m \u001b[1;33m/=\u001b[0m \u001b[0mscale\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[1;32m--> 585\u001b[1;33m     \u001b[0mc\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mresids\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mrank\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0ms\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mlstsq\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mlhs\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mrhs\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mrcond\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0m\u001b[0;32m    586\u001b[0m     \u001b[0mc\u001b[0m \u001b[1;33m=\u001b[0m \u001b[1;33m(\u001b[0m\u001b[0mc\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mT\u001b[0m\u001b[1;33m/\u001b[0m\u001b[0mscale\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m.\u001b[0m\u001b[0mT\u001b[0m  \u001b[1;31m# broadcast scale coefficients\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m    587\u001b[0m \u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;32mD:\\python anaconda\\lib\\site-packages\\numpy\\linalg\\linalg.py\u001b[0m in \u001b[0;36mlstsq\u001b[1;34m(a, b, rcond)\u001b[0m\n\u001b[0;32m   1963\u001b[0m         \u001b[0mwork\u001b[0m \u001b[1;33m=\u001b[0m \u001b[0mzeros\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;33m(\u001b[0m\u001b[0mlwork\u001b[0m\u001b[1;33m,\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m,\u001b[0m \u001b[0mt\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   1964\u001b[0m         results = lapack_routine(m, n, n_rhs, a, m, bstar, ldb, s, rcond,\n\u001b[1;32m-> 1965\u001b[1;33m                                  0, work, lwork, iwork, 0)\n\u001b[0m\u001b[0;32m   1966\u001b[0m     \u001b[1;32mif\u001b[0m \u001b[0mresults\u001b[0m\u001b[1;33m[\u001b[0m\u001b[1;34m'info'\u001b[0m\u001b[1;33m]\u001b[0m \u001b[1;33m>\u001b[0m \u001b[1;36m0\u001b[0m\u001b[1;33m:\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n\u001b[0;32m   1967\u001b[0m         \u001b[1;32mraise\u001b[0m \u001b[0mLinAlgError\u001b[0m\u001b[1;33m(\u001b[0m\u001b[1;34m'SVD did not converge in Linear Least Squares'\u001b[0m\u001b[1;33m)\u001b[0m\u001b[1;33m\u001b[0m\u001b[0m\n",
      "\u001b[1;31mValueError\u001b[0m: On entry to DGELSD parameter number 4 had an illegal value"
     ]
    }
   ],
   "source": [
    "fit = np.polyfit(x=df_pp.query(\"年==2015\")['coal'], y=df_pp.query(\"年==2015\")['gas'], deg=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [],
   "source": [
    "a=\"hanteng,i tried to solve this problem but failed.\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'hanteng,i tried to solve this problem but failed.'"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "a"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
